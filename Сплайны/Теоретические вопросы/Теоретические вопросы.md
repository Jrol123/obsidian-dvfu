# 1. Вывести базисные функции для эрмитового сплайна
## Решение
$S_{3, 2}\left( x \right) = a_{i_{0}} + a_{i_{1}}\left( x - x_{i} \right) + a_{i_{2}}\left( x - x_{i} \right)^{2} + a_{i_{3}}\left( x - x_{i} \right)^{3}$
$t = \dfrac{x - x_{i}}{h_{i}}$

Рассмотрим отрезок $\left[ x_{i}, x_{i + 1} \right]$
$h = h_{i}$
$S\left( x_{i} \right) = a_{0} = f_{i}$
$S'\left( x_{i} \right) = a_{1} = f'_{i}$
$S\left( x_{i + 1} \right) = a_{0} + a_{1}\cdot h + a_{2}\cdot h^{2} + a_{3}\cdot h^{3} = f_{i + 1}$
$S'\left( x_{i + 1} \right) = a_{1} + 2a_{2}\cdot h + 3a_{3}\cdot h^{2} = f'_{i + 1}$

$\begin{cases} a_{3}h^{3} + a_{2}h^{2} = f_{i + 1} - f_{i} - f'_{i}\cdot h \\ 3a_{3}h^{2} + 2 a_{2}h = f'_{i + 1} - f'_{i} \end{cases}$
$\begin{cases} 2a_{3}h^{3} + 2a_{2}h^{2} = 2f_{i + 1} - 2f_{i} - 2f_{fi}' \cdot h  \\ 3a_{3}h^{3} + 2a_{2}h^{2} = \left( f'_{i + 1} - f'_{i} \right) \cdot h \end{cases}$
$\implies \left( f'_{i + 1} - f'_{i} \right) \cdot h - 3a_{3}h^{3} = 2f_{i + 1} - 2f_{i} - 2f_{fi}' \cdot h - 2a_{3}h^{3}$
$a_{3} = \dfrac{\left( f'_{i + 1} - f'_{i} \right) \cdot h - 2\left( f_{i + 1} - f_{i} - f_{fi}' \cdot h \right)}{h^{3}} = \dfrac{\left( f'_{i + 1} + f'_{i} \right)\cdot h - 2\left( f_{i + 1} - f_{i} \right)}{h^{3}}$
$a_{2} = -\dfrac{\left( f_{i + 1}' + 2f_{i}' \right)h - 3\left( f_{i + 1} - f_{i} \right)}{h^{2}}$

$S\left( x \right) = a_{3}h^{3}t^{3} + a_{2}h^{2}t^{2} + f'_{i}th + f_{i}$
$S\left( x \right) = h_{i}\left( f'_{i + 1} + f'_{i} \right)t^{3} - 2\left( f_{i + 1} - f_{i} \right)t^{3} + 3\left(f_{i+1}-f_{i}\right)t^{2}-h_{i}\left(f'_{i+1}+2f'_{i}\right)t^{2}+f'_{i}th_{i}+f_{i}$
$S\left(x\right)=h_{i}t^{3}\cdot f'_{i+1}+h_{i}t^{3}\cdot f'_{i}-2t^{3}\cdot f_{i+1}+2t^{3}\cdot f_{i}+3t^{2}\cdot f_{i+1}-3t^{2}\cdot f_{i}-h_{i}t^{2}\cdot f'_{i+1}+2h_{i}t^{2}\cdot f'_{i}+th_{i}\cdot f'_{i}+f_{i}$

$\phi_{1} = \left( 1-t \right)^{2}\left( 1 + 2t \right)$
$\phi_{2} = t^{2}\left( 3 - 2t \right)$
$\phi_{3} = t\left( 1 - t \right)^{2}$
$\phi_{4} = t^{2}\left( t - 1 \right)$

# 2. Вывести (получить схему и вид)  кубический сплайн $C^{2}$ по моментам, по наклонам, 1-е граничное, 2-е граничное
## По наклонам
### 1-е граничное
$S_i(x) = y_i \cdot H_1(t) + y_{i+1} \cdot H_2(t) + h_i \cdot m_i \cdot H_3(t) + h_i \cdot m_{i+1} \cdot H_4(t)$

где \($t = \frac{x - x_i}{h_i}\), \(h_i = x_{i+1} - x_i$\)

Вторые производные базисных функций Эрмита:
$$$\begin{aligned}
H_1''(t) &= 12t - 6 \\
H_2''(t) &= -12t + 6 \\
H_3''(t) &= 6t - 4 \\
H_4''(t) &= 6t - 2
\end{aligned}$$

Вторая производная сплайна на отрезке \($x_i, x_{i+1}$\):

$S_i''(x) = \dfrac{1}{h_i^2} \left[ y_i \cdot H_1''(t) + y_{i+1} \cdot H_2''(t) + h_i \cdot m_i \cdot H_3''(t) + h_i \cdot m_{i+1} \cdot H_4''(t) \right]$

$S_{i-1}''(x_i) = S_i''(x_i)$

**Левая производная** (на отрезке \($[x_{i-1}, x_i]$\):
$S_{i-1}''(x_i) = \dfrac{1}{h_{i-1}^2} \left[ 6y_{i-1} - 6y_i + h_{i-1}(2m_{i-1} + 4m_i) \right]$

**Правая производная** (на отрезке \([x_i, x_{i+1}]\):
$S_i''(x_i) = \dfrac{1}{h_i^2} \left[ -6y_i + 6y_{i+1} + h_i(-4m_i - 2m_{i+1}) \right]$

Приравниваем и умножаем на \($h_{i-1}^2 h_i^2$\):

$h_i^2[6(y_{i-1} - y_i) + h_{i-1}(2m_{i-1} + 4m_i)] = h_{i-1}^2[6(y_{i+1} - y_i) - h_i(4m_i + 2m_{i+1})]$

После преобразований получаем для **внутренних узлов**:

$\dfrac{h_i}{h_{i-1}}m_{i-1} + 2\left(1 + \frac{h_i}{h_{i-1}}\right)m_i + m_{i+1} = 3\left[\frac{y_{i+1} - y_i}{h_i} + \frac{y_i - y_{i-1}}{h_{i-1}}\right]$

### 2-е граничное
$$
\begin{cases}
H_{1}'' = 12t - 6 \\
H_{2}'' = -12y + 6 \\
H_{3}'' = 6t - 4 \\
H_{4}'' = 6t - 2
\end{cases}
$$
$S_{i}''\left( x \right) = \dfrac 1 {h^{2}} \left( y_{i} H_{1}'' + y_{i + 1}H_{2}'' + hm_{i} \cdot H_{3}'' + hm_{i + 1}\cdot H_{4}'' \right)$
По условию непрерывности $S_{i - 1}\left( x_{i} \right)'' = S_{i}''\left( x_{i} \right)$
$S''_{i - 1}\left( x_{i} \right) = \dfrac 1 {h_{i - 1}^{2}}\left( 6y_{i - 1} - 6y_{i} + h_{i}\left( 2m_{i - 1} + 4m_{i} \right) \right) | t = 1$
$S''_{i}\left( x_{i} \right) = \dfrac 1 {h_{i - 1}^{2}}\left( - 6y_{i} + 6y_{i + 1} + h_{i}\left( -4m_{i} - 2m_{i + 1} \right) \right) | t = 0$
Приравниваем, домножаем на $h^{2}_{i - 1}h^{2}_{i}$ и получаем уравнение для внутренних узлов

$\dfrac{h_{i}}{h_{i - 1}}m_{i - 1} + 2\left( 1 + \dfrac{h_{i}}{h_{i - 1}} \right)m_{i} + m_{i + 1} = 3\left( \dfrac{y_{i + 1} - y_{i}}{h_{i}} + \dfrac{y_{i} - y_{i - 1}}{h_{i - 1}} \right)$

**Левая граница** (\(x = x_0\), \(t = 0\)):

$S_0''(x_0) = \frac{1}{h_0^2}[-6y_0 + 6y_1 + h_0(-4m_0 - 2m_1)] = f''_0$

Умножаем на ($h_0^2$):
$-6(y_1 - y_0) - 4h_0m_0 - 2h_0m_1 = f''_0 h_0^2$

Переносим:
$4h_0m_0 + 2h_0m_1 = 6(y_1 - y_0) - f''_0 h_0^2$

Делим на ($h_0$):
$4m_0 + 2m_1 = \frac{6(y_1 - y_0)}{h_0} - f''_0 h_0$

**Правая граница** (\(x = x_N\), \(t = 1\)):

$S_{N-1}''(x_N) = \frac{1}{h_{N-1}^2}[6y_{N-1} - 6y_N + h_{N-1}(2m_{N-1} + 4m_N)] = f''_N$

Умножаем на \($h_{N-1}^2$):
$6(y_{N-1} - y_N) + 2h_{N-1}m_{N-1} + 4h_{N-1}m_N = f''_N h_{N-1}^2$

Переносим:
$2h_{N-1}m_{N-1} + 4h_{N-1}m_N = 6(y_N - y_{N-1}) + f''_N h_{N-1}^2$

Делим на ($h_{N-1}$):
$2m_{N-1} + 4m_N = \dfrac{6(y_N - y_{N-1})}{h_{N-1}} + f''_N h_{N-1}$

## По моментам
$S''\left( x \right) = m_{i} \cdot \left( 1 - t \right) + m_{i + 1}\cdot t$
$t = \dfrac{x - x_{i}}{h_{i}}$

$S_{i}\left(x\right)=M_{i}\cdot\dfrac{\left(x_{i+1}-x\right)^{3}}{6h_{i}}+M_{i+1}\cdot\dfrac{\left(x-x_{i}\right)^{3}}{6h_{i}}+A_{i}\left(x-x_{i}\right)+B_{i}$
По условию интерполяции ($S\left( x_{i} \right) = f\left( x_{i} \right)$):
$S_{i}\left(x_{i}\right)=M_{i}\cdot\frac{h_{i}^{2}}{6}+B_{i}=f_{i}\to B_{i}=f_{i}-M_{i}\cdot\frac{h_{i}^{2}}{6}$
$S_{i}\left(x_{i+1}\right)=M_{i+1}\cdot\frac{h_{i}^{2}}{6}+A_{i}h_{i}+f_{i}-M_{i}\cdot\frac{h_{i}^{2}}{6}=f_{i+1}\to A_{i}=\frac{f_{i+1}-f_{i}}{h_{i}}-\frac{h_{i}}{6}\left(M_{i+1}-M_{i}\right)$

Итого:
$S_{i}\left(x\right)=M_{i}\cdot\frac{\left(x_{i+1}-x\right)^{3}}{6h_{i}}+M_{i+1}\cdot\frac{\left(x-x_{i}\right)^{3}}{6h_{i}}+\left(\frac{f_{i+1}-f_{i}}{h_{i}}-\frac{h_{i}}{6}\left(M_{i+1}-M_{i}\right)\right)\left(x-x_{i}\right)+f_{i}-M_{i}\cdot\frac{h_{i}^{2}}{6}$
Получим уравнение системы для моментов:
$S_{i}'\left(x_{i}\right)=-\frac{M_{i}\cdot h_{i}}{3}-\frac{M_{i+1}\cdot h_{i}}{6}+\frac{f_{i+1}-f_{i}}{h_{i}}$
$S_{i-1}'\left(x_{i}\right)=\frac{M_{i-1}\cdot h_{i-1}}{6}+\frac{M_{i}\cdot h_{i-1}}{3}+\frac{f_{i}-f_{i-1}}{h_{i-1}}$

Из условия непрерывности для первой производной получим:
$\frac{M_{i-1}\cdot h_{i-1}}{6}+\frac{M_{i}\cdot h_{i-1}}{3}+\frac{f_{i}-f_{i-1}}{h_{i-1}}=-\frac{M_{i}\cdot h_{i}}{3}-\frac{M_{i+1}\cdot h_{i}}{6}+\frac{f_{i+1}-f_{i}}{h_{i}}$
$\frac{h_{i-1}}{6}\cdot M_{i-1}+\frac{h_{i-1}+h_{i}}{3}\cdot M_{i}+\frac{h_{i}}{6}\cdot M_{i+1}=\frac{f_{i+1}-f_{i}}{h_{i}}-\frac{f_{i}-f_{i-1}}{h_{i-1}}$

### 1-е граничное
$S'_{0}=f'_{0}=-\frac{M_{0}h_{0}}{3}-\frac{M_{1}h_{0}}{6}+\frac{y_{1}-y_{0}}{h_{0}}$
$S'_{N}=f'_{N}=-\frac{M_{N-1}h_{N-1}}{3}-\frac{M_{N}h_{N-1}}{6}+\frac{y_{N}-y_{N-1}}{h_{N-1}}$
### 2-е граничное
$M_{0}=f''_{0}$
$M_{N}=f''_{N}$
