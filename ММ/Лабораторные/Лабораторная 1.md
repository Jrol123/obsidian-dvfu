**Поповкин Артемий Андреевич**
**Б9122-02.03.01 СЦТ**

## Структура

  

1. Постановка задачи/Описание модели.

    - Здесь описываем модель, то есть пишем, что, какие процессы или взаимодействия описывают уравнения системы. Далее указываем, какие переменные в системе являются фазовыми, какие представляют из себя параметры системы, что является входными (начальными или краевыми данными), что из себя представляет решение.

2. Аналитическое исследование системы.

    - Решаем модель аналитически, когда это возможно. Определяем точки равновесия. Исследуем каждую равновесную точку на устойчивость.

3. Численное решение модели.

    - Формируем самостоятельно входной датасет, отображающий некоторую экологическую/биологическую/социально-экономическую ситуацию. Формулируем задачу, которую можно решить, используя заданную модель. Находим решение численно. Отображаем его визуально с помощью соответствующего графиков, а именно:

        1. динамическое поведение модели;

        2. фазовый портрет модели.

3. Заключение.

    - Кратко пишем, что узнали, что прокачали.

5. Текст скрипта.

  

Структура примерная. Вы можете миксовать описанные задачи в произвольном порядке и разбивать отчет на параграфы, как вам кажется логичным. Также нет ограничений в использовании программного языка. Кому на чем удобнее, на том и пишем. Титульник не обязательно. Историческую справку хотите пишите (из любознательности, но это бывает на самом деле интересно, мы же становимся специалистами с высшим, то есть с разносторонним образованием), хотите нет, но я это безусловно оцениваю.
# Постановка задачи
Требуется:
1. Для модели Мальтуса:
	1. определить численность популяции в будущем времени на основе начальной численности и темпа роста.
2. Для логистической модели:
	1. Исследовать изменение численности популяции с течением времени с учетом начальной численности, темпа роста и емкости среды.
# Описание моделей
## Модель Мальтуса
### Описание
Модель Мальтуса описывает процесс неограниченного роста популяции в условиях избытка ресурсов.
Основное предположение модели - скорость роста популяции пропорциональна ее текущей численности.
### Обозначения
- $t$ — время (размерность: годы)
#### Входные данные
- $P_{0}$ — начальная численность популяции. (размерность: тысячи)
#### Фазовые переменные
- $P(t)$ — численность популяции в момент времени $t$.
#### Параметры
- $r$ — темп роста (разница между рождаемостью и смертностью в  единицу времени)
### Уравнение
$$
\dfrac{dP}{dt} = rP
$$
Решением уравнения будет называть функцию, удовлетворяющую следующей задаче Коши:
$$
\begin{cases}
P' = rP \\
P(0) = P_{0}
\end{cases}
$$
## Логистическая модель
### Описание
### Обозначения
- $t$ — время (размерность: годы)
#### Входные данные
- $P_{0}$ — начальная численность популяции. (размерность: тысячи)
#### Фазовые переменные
- $P(t)$ — численность популяции в момент времени $t$.
#### Параметры
- $r$ — темп роста (разница между рождаемостью и смертностью в  единицу времени)
- $k$ — ёмкость среды (максимальная численность популяции, которую может поддерживать среда)
### Уравнение
$\dfrac{dP}{dt} = rP\left( 1 - \dfrac{P}{k} \right)$

Решением уравнения будет называть функцию, удовлетворяющую следующей задаче Коши:
$$
\begin{cases}
P' = rP\left( 1 - \dfrac{P}{k} \right)  \\
P(0) = P_{0}
\end{cases}
$$
# Аналитическое исследование систем
## Модель Мальтуса
### Поиск аналитического решения
$\dfrac{dP}{dt} = rP$
$\dfrac{dP}{P} = rdt$
$\ln \left( P \right) = rt + C \implies P\left( t \right) = Ce^{rt}$
Константу $C$ получим из начального условия: $P_{0} = P(0) = C$

Таким образом, общее решения задачи имеет вид:
$$
P\left( t \right)  = P_{0} \cdot e^{rt}
$$

### Условие устойчивости
Для начала найдём равновесия модели:
$rP = 0 \implies P = 0$
Следовательно существует лишь тривиальное решение $P_{t} = 0$

Теперь исследуем полученную равновесную точку на устойчивость:
$\left( rP \right)'_{x} = r$

Получим следующие случаи:
1. $r > 0$
	1. Неподвижная точка $P_{t}$ **неустойчива**, численность популяции неограниченно растёт
2. $r < 0$
	1. Неподвижная точка $P_{t}$ **неустойчива**, численность популяции неограниченно растёт
3. $r = 0$
	1. Неподвижная точка $P_{t}$ **устойчива**, численность популяции не меняется со временем

## Логистическая модель
### Поиск аналитического решения
$\dfrac{dP}{dt} = rP\left( 1 - \dfrac{P}{k} \right)$
$\dfrac{PdP}{P\left( k -  P \right)} = rdt$
$\dfrac{dP}{P} + \dfrac{dP}{k - P} = rdt$
$\ln \left( \dfrac{P}{k - P} \right) = rt + C$
$\dfrac{P}{k - P} = Ce^{rt}$
$\left( 1 + Ce^{rt}P \right) = kCe^{rt}$
$P\left( t \right) = \dfrac{kCe^{rt}}{1 + Ce^{rt}}$
Константу $C$ получим из начального условия: $\dfrac{kC}{1 + C} = P_{0}\implies kC = \left( 1 + C \right)P_{0} \implies C = \dfrac{P_{0}}{k - P_{0}}$

Таким образом, общее решения задачи имеет вид:
$$
P\left( t \right) = \dfrac{kP_{0}\cdot e^{rt}}{k - P_{0} + P_{0}e^{rt}}
$$

### Условие устойчивости
Для начала найдём равновесия модели:
$\dfrac{dP}{dt} = rP\left( 1 - \dfrac{P}{k} \right) = 0$

Получаем два равновесия:
1. $P_{t} = 0$
2. $P_{nt} = k$

Теперь исследуем полученные точки на устойчивость:
$\left( rP\left( 1 - \dfrac{P}{k} \right) \right)'_{P} = r - \dfrac{rP}{k} - \dfrac{rP}{k} = r - 2\dfrac{rP}{k}$
Подставляя неподвижные точки получим два случая:
1. $r > 0$
	1. Нетривиальное равновесие устойчиво при $\forall P > 0$.
2. $r < 0\ \cap \ P_{0} < k$
	1. Тривиальное равновесие устойчивым на всём интервале $\left( 0, k \right)$.

# Численные эксперименты
Для обоих моделей был выбран временной диапазон с 2014 по 2020 гг.
Популяция указана в тысячах
## Модель Мальтуса
Для Мальтуса была выбрана популяция Китая.
Начальные данные:

| year<br><br> | persons | birth_rate | death_rate | natural_rate |
| ------------ | ------- | ---------- | ---------- | ------------ |
| 2014         | 1371860 | 13.83      | 7.12       | 6.71         |
| 2015         | 1379860 | 11.99      | 7.07       | 4.93         |
| 2016         | 1387790 | 12.95      | 7.09       | 5.86         |
| 2017         | 1396215 | 12.64      | 7.06       | 5.58         |
| 2018         | 1402760 | 10.86      | 7.08       | 3.78         |
| 2019         | 1407745 | 10.41      | 7.09       | 3.32         |
| 2020         | 1411100 | 8.52       | 7.07       | 1.45         |

Без корректировки:
![[Pasted image 20251023104631.png]]
![[Pasted image 20251023104718.png]]


С корректировкой на 0.04:
![[Pasted image 20251023104651.png]]
![[Pasted image 20251023104731.png]]

### Вывод
Примерно в 2021-м году Китай вышел на своё плато по количеству населения, и уже несколько лет население в нём падает. Но помимо этого результат вполне приемлемый.

## Логистическая модель
Для логистической модели была выбрана популяция Казахстана
В качестве плато предположил, что численность будет увеличиваться до 1 миллиарда (с учётом быстрого роста Казахстана)
Начальные данные:

| year<br><br> | persons | birth_rate | death_rate | natural_rate |
| ------------ | ------- | ---------- | ---------- | ------------ |
| 2014         | 17289   | 23.1       | 7.6        | 15.5         |
| 2015         | 17557   | 22.7       | 7.5        | 16.2         |
| 2016         | 17818   | 22.52      | 7.4        | 15.6         |
| 2017         | 18014   | 21.7       | 7.2        | 14.4         |
| 2018         | 18437   | 21.8       | 7.1        | 14.7         |
| 2019         | 18789   | 21.8       | 7.2        | 14.6         |
| 2020         | 18129   | 22.8       | 8.7        | 14.1         |


Без корректировки:
![[Pasted image 20251023111006.png]]
![[Pasted image 20251023111016.png]]

С корректировкой:
![[Pasted image 20251023111031.png]]
![[Pasted image 20251023111037.png]]

В 2020-м году в Казахстане произошёл довольно сильный отток населения, который был позже компенсирован в 2021-м. Так что модель прогнозирует вполне приемлемо.
# Заключение

# Использованные данные
1. https://ru.wikipedia.org/wiki/Население_Китая#Численность_населения_КНР_с_1949_по_2024_год
2. https://ru.wikipedia.org/wiki/Население_Казахстана#Демографические_данные

# Листинг кода
```python
# Imports
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
# Global variables

#Переменные для вычисления (шаг и т. д.)
time_step = 1  # Шаг в годах
additional_prognosis_years = 0


def get_time_array(start: int, end: int, step: float) -> np.ndarray:
    return np.arange(start, end + step, step)
# Funcs
## Math
def malthus_model(t: float, P0: float, r: float) -> float:
    """Вычисляет популяцию по модели Мальтуса.

    Args:
        t (float): Время.
        P0 (float): Начальная численность.
        r (float): Коэффициент роста.

    Returns:
        float: Численность популяции в момент t.
    """
    return P0 * np.exp(r * t)


def logistic_model(t: float, P0: float, r: float, K: float) -> float:
    """Вычисляет популяцию по логистической модели.

    Args:
        t (float): Время.
        P0 (float): Начальная численность.
        r (float): Коэффициент роста
        K (float): Ёмкость среды.        

    Returns:
        float: Численность популяции в момент t.
    """
    return (K * P0 * np.exp(r*t)) / (K - P0 + P0 * np.exp(r*t))
## Graphics
def plot_population(
    t: float,
    P: float,
    label_model: str,
    t_observed: float = None,
    P_observed: float = None,
) -> None:
    """Построение графика популяции

    Args:
        t (float): Время прогноза.
        P (float): Прогноз.
        label_model (str): Наименование модели
        t_observed (float, optional): Время наблюдений. Defaults to None.
        P_observed (float, optional): Наблюдения. Defaults to None.
    """
    plt.figure(figsize=(10, 6))
    plt.plot(t, P, "b-", linewidth=2, label=label_model)
    if t_observed is not None and P_observed is not None:
        plt.plot(
            t_observed, P_observed, "ro", markersize=6, label="Оригинальные данные"
        )
    plt.xlabel("Время")
    plt.ylabel("Численность популяции")
    plt.legend()
    plt.grid(True, alpha=0.3)
    plt.show()
# China (Malthus)
## Data check

Последняя строка проверочная
df_china = pd.read_csv("../data/china.csv", index_col=0, dtype={"persons": "int"})
china_person_multiplier = int(1e3)

df_china
calc_idx_china = 0

china_timeline = df_china.index
china_population_timeline = df_china["persons"]

starting_year_china = china_timeline[calc_idx_china]
predict_idx_china = [i for i in range(1, len(df_china))]
interval_len_china = len(df_china) - 1

birth_rate_mean_china = df_china["birth_rate"].mean()
death_rate_mean_china = df_china["death_rate"].mean()
natural_rate_mean_china = df_china["natural_rate"].mean()
P0_china = df_china["persons"].iloc(0)[0]
r_china = natural_rate_mean_china / 100
r_china

## Calculation
### Malthus
t_china = get_time_array(
    starting_year_china - starting_year_china,
    df_china.index[predict_idx_china[-1]] - starting_year_china + additional_prognosis_years,
    time_step,
)
P_malthus_china = malthus_model(
    t_china,
    P0_china,
    r_china - 0.04,
)
P_malthus_china
df_malthus_china = pd.DataFrame({"year": t_china + starting_year_china, "persons": P_malthus_china})
df_malthus_china.set_index("year", inplace=True)
df_malthus_china
china_population_timeline
plot_population(t_china + starting_year_china, P_malthus_china, "Модель Мальтуса", china_timeline, china_population_timeline)
### Logistic
t_china = get_time_array(
    starting_year_china - starting_year_china,
    df_china.index[predict_idx_china[-1]] - starting_year_china + additional_prognosis_years,
    time_step,
)
P_logistic_china = logistic_model(
    t_china,
    P0_china,
    r_china + 0.3,
    1412360,
)
P_logistic_china
df_logistic_china = pd.DataFrame(
    {"year": t_china + starting_year_china, "persons": P_logistic_china}
)
df_logistic_china.set_index("year", inplace=True)
df_logistic_china
plot_population(
    t_china + starting_year_china,
    P_logistic_china,
    "Логистическая модель",
    china_timeline,
    china_population_timeline,
)
# Kazahstan
## Data check
df_kaz = pd.read_csv("../data/kazahstan.csv", index_col=0, dtype={"persons": "int"})
kaz_person_multiplier = int(1e3)

df_kaz
calc_idx_kaz = 0

kaz_timeline = df_kaz.index
kaz_population_timeline = df_kaz["persons"]

starting_year_kaz = kaz_timeline[calc_idx_kaz]
predict_idx_kaz = [i for i in range(1, len(df_kaz))]
interval_len_kaz = len(df_kaz) - 1

birth_rate_mean_kaz = df_kaz["birth_rate"].mean()
death_rate_mean_kaz = df_kaz["death_rate"].mean()
natural_rate_mean_kaz = df_kaz["natural_rate"].mean()
P0_kaz = df_kaz["persons"].iloc(0)[0]
r_kaz = natural_rate_mean_kaz / 100
r_kaz

## Calculation
### Logistic
t_kaz = get_time_array(
    starting_year_kaz - starting_year_kaz,
    df_kaz.index[predict_idx_kaz[-1]] - starting_year_kaz + additional_prognosis_years,
    time_step,
)
P_logistic_kaz = logistic_model(
    t_kaz,
    P0_kaz,
    r_kaz - 0.135,
    int(1e6),
)
P_logistic_kaz
df_logistic_kaz = pd.DataFrame({"year": t_kaz + starting_year_kaz, "persons": P_logistic_kaz})
df_logistic_kaz.set_index("year", inplace=True)
df_logistic_kaz
plot_population(
    t_kaz + starting_year_kaz,
    P_logistic_kaz,
    "Логистическая модель",
    kaz_timeline,
    kaz_population_timeline,
)
```
