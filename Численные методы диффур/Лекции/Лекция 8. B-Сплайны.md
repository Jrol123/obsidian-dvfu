## B-Сплайны
$$
S(x)=\sum\limits_{i=-1}^{N+1}b_i B_i(x)
$$
$$
B_i(x)=\dfrac 1 6 \cases{
{0 \quad x < x_{i-2}} \\
{t^3 \quad x_{i-1}\le x < x_{i-1}} \\
{1 + 3t + 3t^3(1-t)\quad x_{i-1}\le x < x_{i}} \\
{1+3(1-t) + 3t(1-t)^2 \quad x_i \le x < x_{i+1}} \\
{(1-t)^3 \quad x_{i+1} \le x < x_{i+2}} \\
{0 \quad x\ge x_{i+2}}
}
$$
**Для замыкания системы добавляем к сетке по 3 дополнительные точки справа и слева**

$$
\sum\limits_{i=-1}^{N+1}b_i B''_i(x)+p(x) \sum\limits_{i=-1}^{N+1}b_i B_i'(x) + q(x) \sum\limits_{i=-1}^{N+1} b_i B_i(x)=r(x)
$$
$$
\sum\limits_{i=-1}^{N+1} b_i \left( B_i''(x) + p(x) B_i'(x) + q(x)B_i(x) \right) = r(x)
$$
$$
\sum\limits_{i=-1}^{N+1} b_i L[B_i(x)]=r(x)
$$
Пусть $x_i = \xi_i$
$$
b_{i-1}L[B_{i-1}(x_i)] + b_i L[B_i(x_i)] + b_{i+1} L[B_{i+1}(x_i)] = r_i \quad i = \overline{0,N}
$$
**Добавляем граничные условия**
$$
\matrix{
\alpha_1 S(x_0) + b_1S'(x_0)=\gamma_1
}
$$

**Погрешность $\|y(x)-S(x)\|_C = O(\overline {h ^ 2})$**

## Формулы повышенной точности
![[Лекция 8. B-Сплайны 2025-04-10 12.28.09.excalidraw]]
$$
\Delta:N=2n+1
$$
$$
\xi_{2i}=x_{2i}+t_{2i}\cdot h_{2i}
$$
$$
\xi_{2i+1}=x_{2i}+t_{2i+1}\cdot h_{2i}
$$
$$
0\le t_{2i} \le t_{2i+1} \le 1
$$
**Пример для равномерной сетки**
$$
\xi_{2i}=x_{2i}+\nu h
$$
$$
x_{2i+1}=x_{2i}-\nu h
$$
$$
\nu = \dfrac 1 2 - \dfrac{\sqrt 3}{6}
$$

**Кульбит**
$$
\dfrac{f_{i-1}-2f_i+f_{i+1}}{h^2} = f''_i+\dfrac 1 {12} h^2 f^{(4)}_i + O(h^4)
$$
$$
\mu_i=f''_i - \dfrac 1 {12} h^2 f_i^{(4)} + O(h^4)
$$
$$
\dfrac 1 2 \left( \mu_i + \dfrac{f_{i-1}-2f_i+f_{i+1}}{h^2} \right)= f_i''+O(h^4)
$$
**Кульбит по смешнее**
$$
\dfrac{M_{i-1}-2M_i + M_{i+1}}{h^2} = f_i^{(4)}+O(h^4)
$$
$$f_i^{(4)} = 0$$
Получили аппроксимацию 0 с 4 порядком точности

**Плюсы**
- Одинаково эффективно на любых сетках 
- Высокая точность аппроксимации первой производной
- Простота построения схем повышенной точности
- Решение и его производная вычисляются в любых точках области

